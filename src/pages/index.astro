---
import ItemCard from "@components/ItemCard";
import MainNav from "@layouts/MainNav.astro";

import axios from "axios";
const pb_loc = import.meta.env.PB_LOCATION;

const url = new URL(Astro.request.url);
const search = url.searchParams.get("search") as string | null;

const res = await axios.get(
  `${pb_loc}/api/collections/item/records?filter=title ~ "${search || ""}"`
);
const items = res.data.items;
---

<MainNav>
  {items.map((item: Item) => <ItemCard data={{ ...item }} />)}
</MainNav>
