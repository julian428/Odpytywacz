---
import axios from "axios";
import type { itemType } from "../../types/database";

//! replace the owner id with the logged in user id
const api = import.meta.env.API_URL;
const items = await axios.get(
  `${api}/api/items.json?query=owner = "i3jpejj5qsvjg5n"`
);

const itemsData = items.data;

const questionTemplate =
  "<li><a href='/dashboard/question/$id$' >$answears$</a></li>";
---

<ul class="menu menu-xs bg-base-200 rounded-lg max-w-xs w-full">
  {
    itemsData.map((item: itemType, index: number) => (
      <li>
        <details>
          <summary>{item.title}</summary>
          <ul>
            <li>
              <a href={`/dashboard/article/${item.id}`}>article</a>
            </li>
            <li
              hx-trigger="mouseover once"
              hx-get={`/api/questions.json?query=item = "${item.id}"&template=${questionTemplate}`}
              hx-target={"#item-" + index + "-questions"}
            >
              <details>
                <summary>questions</summary>
                <ul id={"item-" + index + "-questions"} />
              </details>
            </li>
          </ul>
        </details>
      </li>
    ))
  }
</ul>
